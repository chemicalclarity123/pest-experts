---
// src/layouts/Layout.astro
// Base layout with centralized SEO management
import Navbar from '../components/Navbar.astro';
import Seo from '../components/Seo.astro';
import '../styles/global.css';

interface Props {
	title?: string;
	description?: string;
	seo?: any;
	schemaMarkup?: any | any[];
	ogImage?: string; // Legacy support
	canonicalUrl?: string; // Legacy support
}

const { 
	title, 
	description,
	seo,
	schemaMarkup,
	ogImage,
	canonicalUrl
} = Astro.props;

// Prepare SEO object from both new and legacy props
const seoData = seo || {
	metaTitle: title,
	metaDescription: description,
	shareImage: ogImage,
	canonicalUrl: canonicalUrl
};
---

<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width" />
	<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
	
	<Seo 
		title={title}
		description={description}
		seo={seoData}
		schemaMarkup={schemaMarkup}
	/>
	
	<!-- Additional head content -->
	<slot name="head" />

	<!-- Google Tag Manager â€” reemplazar GTM-XXXXXXX con el ID real del contenedor -->
	<script is:inline>
		window.dataLayer = window.dataLayer || [];
	</script>
	<script is:inline>
		(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-XXXXXXX');
	</script>
</head>
<body>
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"
	height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

	<Navbar />
	<main>
		<slot />
	</main>
	<slot name="footer" />
</body>
</html>

<!-- Estilos globales centralizados en src/styles/global.css -->
